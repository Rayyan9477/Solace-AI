"""Solace-AI Security Library - Authentication, Authorization, Encryption, Audit, PHI Protection."""
from solace_security.auth import (
    TokenType,
    AuthSettings,
    TokenPayload,
    TokenPair,
    AuthenticationResult,
    PasswordHasher,
    JWTManager,
    APIKeyGenerator,
    SessionManager,
    create_jwt_manager,
    create_session_manager,
)
from solace_security.authorization import (
    Permission,
    Role,
    ROLE_PERMISSIONS,
    ResourceType,
    AuthorizationContext,
    Resource,
    AuthorizationDecision,
    Policy,
    RBACPolicy,
    OwnershipPolicy,
    ResourceTypePolicy,
    TimeBasedPolicy,
    IPRestrictionPolicy,
    AttributeBasedPolicy,
    PolicyEngine,
    Authorizer,
    create_default_policy_engine,
    create_authorizer,
)
from solace_security.encryption import (
    EncryptionAlgorithm,
    KeyDerivationFunction,
    EncryptionSettings,
    EncryptedData,
    KeyManager,
    AESGCMCipher,
    Encryptor,
    FieldEncryptor,
    SecureTokenGenerator,
    create_encryptor,
    create_field_encryptor,
)
from solace_security.audit import (
    AuditEventType,
    AuditOutcome,
    AuditSeverity,
    AuditSettings,
    AuditActor,
    AuditResource,
    AuditEvent,
    AuditStore,
    InMemoryAuditStore,
    AuditLogger,
    get_audit_logger,
    create_audit_logger,
)
from solace_security.phi_protection import (
    PHIType,
    PHISettings,
    PHIMatch,
    PHIDetectionResult,
    PHIPattern,
    DEFAULT_PATTERNS,
    PHIMasker,
    PHIDetector,
    PHISanitizer,
    create_phi_detector,
    create_phi_sanitizer,
    detect_phi,
    mask_phi,
)
from solace_security.middleware import (
    AuthenticatedUser,
    AuthenticatedService,
    get_current_user,
    get_current_user_optional,
    get_current_service,
    require_roles,
    require_permissions,
    require_service_permission,
    CurrentUser,
    CurrentService,
)
from solace_security.service_auth import (
    ServiceIdentity,
    ServicePermission,
    SERVICE_PERMISSIONS,
    ServiceAuthSettings,
    ServiceCredentials,
    ServiceAuthResult,
    ServiceTokenManager,
    ServiceAuthenticatedClient,
    get_service_token_manager,
    initialize_service_auth,
)

__all__ = [
    # Auth
    "TokenType",
    "AuthSettings",
    "TokenPayload",
    "TokenPair",
    "AuthenticationResult",
    "PasswordHasher",
    "JWTManager",
    "APIKeyGenerator",
    "SessionManager",
    "create_jwt_manager",
    "create_session_manager",
    # Authorization
    "Permission",
    "Role",
    "ROLE_PERMISSIONS",
    "ResourceType",
    "AuthorizationContext",
    "Resource",
    "AuthorizationDecision",
    "Policy",
    "RBACPolicy",
    "OwnershipPolicy",
    "ResourceTypePolicy",
    "TimeBasedPolicy",
    "IPRestrictionPolicy",
    "AttributeBasedPolicy",
    "PolicyEngine",
    "Authorizer",
    "create_default_policy_engine",
    "create_authorizer",
    # Encryption
    "EncryptionAlgorithm",
    "KeyDerivationFunction",
    "EncryptionSettings",
    "EncryptedData",
    "KeyManager",
    "AESGCMCipher",
    "Encryptor",
    "FieldEncryptor",
    "SecureTokenGenerator",
    "create_encryptor",
    "create_field_encryptor",
    # Audit
    "AuditEventType",
    "AuditOutcome",
    "AuditSeverity",
    "AuditSettings",
    "AuditActor",
    "AuditResource",
    "AuditEvent",
    "AuditStore",
    "InMemoryAuditStore",
    "AuditLogger",
    "get_audit_logger",
    "create_audit_logger",
    # PHI Protection
    "PHIType",
    "PHISettings",
    "PHIMatch",
    "PHIDetectionResult",
    "PHIPattern",
    "DEFAULT_PATTERNS",
    "PHIMasker",
    "PHIDetector",
    "PHISanitizer",
    "create_phi_detector",
    "create_phi_sanitizer",
    "detect_phi",
    "mask_phi",
    # Middleware (FastAPI Authentication Dependencies)
    "AuthenticatedUser",
    "AuthenticatedService",
    "get_current_user",
    "get_current_user_optional",
    "get_current_service",
    "require_roles",
    "require_permissions",
    "require_service_permission",
    "CurrentUser",
    "CurrentService",
    # Service-to-Service Authentication
    "ServiceIdentity",
    "ServicePermission",
    "SERVICE_PERMISSIONS",
    "ServiceAuthSettings",
    "ServiceCredentials",
    "ServiceAuthResult",
    "ServiceTokenManager",
    "ServiceAuthenticatedClient",
    "get_service_token_manager",
    "initialize_service_auth",
]
